{% extends "layout.html" %}

{% block title %}Challenge: {{ challenge.challenge_name }}{% endblock %} 

{% load static %}
{% load challenges_tags %}

{% block main %}
    <section class="container">
        <div class="row">
            <div class="col-xs-2 col-md-2">
                <span class="backlink">
                {% if challenge.is_archived %}
                    <a href="{% url 'challenge-list-archived' %}">
                {% else %}
                    <a href="{% url 'challenge-list' %}">
                {% endif %}
                    <i class="margin-right-5 glyphicon glyphicon-menu-left"></i><span class="backlink__text">Back</span>
                    </a>
                </span>
            </div>
            <h1 class="col-xs-offset-1 col-md-5">{{ challenge.challenge_name }}</h1>            
        </div>
        
        <dl class="col-xs-12 col-md-6 col-md-offset-3">
            <dt>Your Obsession: </dt>
            <dd>{{ challenge.obsession }}</dd>
            <dt>Your Compulsion:</dt>
            <dd>{{ challenge.compulsion }}</dd>
            <dt>Your Exposure:</dt>
            <dd>{{ challenge.exposure }}</dd>
        </dl>

        {% if not challenge.is_archived %} 
            <div class="col-xs-6 col-md-3 col-md-offset-2">
                <a class="button--archive btn btn-lg btn-outline btn-warning pull-right" 
                    href="{% url 'challenge-archive' challenge.id %}" onclick="return checkArchive()";>
                    Archive
                </a>
            </div>           
            <div class="col-xs-6 col-md-3 col-md-offset-1">
                <a class="button--edit btn btn-lg btn-outline btn-primary pull-left" 
                    href="{% url 'challenge-edit' challenge.id %}">
                    Edit
                </a>    
            </div>
        {% endif %}
    </section>

    {% if anxiety_score_cards %}
    <section>
        <ul class="col-xs-6 col-xs-offset-3">
            <h4>Your exposures for this challenge</h4>
            <table class="table table-responsive">
                <thead>
                    <tr>
                        <th></th>
                        <th>Most recent</th>
                        <th></th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Anxiety at 0 min:</td>
                        {% for card in anxiety_score_cards %}
                            <td>{% render_anxiety_level card.anxiety_at_0_min %}</td>
                        {% endfor %}
                    </tr>
                    <tr>
                        <td>Anxiety at 5 min:</td>
                        {% for card in anxiety_score_cards %}
                            <td>{% render_anxiety_level card.anxiety_at_5_min %}</td>
                        {% endfor %}
                    </tr>
                    <tr>
                        <td>Anxiety at 10 min:</td>
                        {% for card in anxiety_score_cards %}
                            <td>{% render_anxiety_level card.anxiety_at_10_min %}</td>
                        {% endfor %}
                    </tr>
                    <tr>
                        <td>Anxiety at 15 min:</td>
                        {% for card in anxiety_score_cards %}
                            <td>{% render_anxiety_level card.anxiety_at_15_min %}</td>
                        {% endfor %}
                    </tr>
                    <tr>
                        <td>Anxiety at 30 min:</td>
                        {% for card in anxiety_score_cards %}
                            <td>{% render_anxiety_level card.anxiety_at_30_min %}</td>
                        {% endfor %}
                    </tr>
                    <tr>
                        <td>Anxiety at 60 min:</td>
                        {% for card in anxiety_score_cards %}
                            <td>{% render_anxiety_level card.anxiety_at_60_min %}</td>
                        {% endfor %}
                    </tr>
                    <tr>
                        <td>Anxiety at 120 min:</td>
                        {% for card in anxiety_score_cards %}
                            <td>{% render_anxiety_level card.anxiety_at_120_min %}</td>
                        {% endfor %}
                    </tr>
                </tbody>
            </table>
        </ul>
    </section>
    {% endif %}

    <script language="javascript">
        function checkArchive() {
            if (confirm("Are you sure you want to archive this challenge? Once archived you will not be able to reactivate it.")) {
                return true;
            } else {
                return false;
            }
        }
    </script>
{% endblock %}
